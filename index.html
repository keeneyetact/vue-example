<html>

<head>
    <title>Standalone Vue Component Example</title>    
    <link rel="stylesheet" href="./css/style.css" type="text/css">
</head>

<body>
    <div id="app">
    </div>

    <div id="meta">
        <div class="image">
            <img src="./img/step2.1.jpg">
        </div>
        <div class="description">
            <p class="current-step-message">
                Under the hood, filtering can be easily implemented with a computed property. See <b>filtered_cat_pins</b> in the source code for implementation details. You can check that it works via console. Good UI, hovewer, requires us to use the event system, which comes in the next example.
            </p>
            <p class="task-message">
                We would really like to keep this set of examples as "question-driven" as possible. So, the next question is: how to implement filtering in response on a click over certain tag, given that this tag lives in a child component? Try to think ahead, and we believe figure out a decent solution before moving to the next @step2.2.
            </p>
            <p class="previous-step-message">
                This example demonstrates the power of Vue components. We build a primitive Pinterest clone, dedicated to cute cats and vanilla songs. Apart from the root Vue instance, we also have a global component <b>cat-pin</b>, which uses a local component <b>author-signature</b>. Both of these components utilize <b>props</b>. We also introduce the concept of <b>computed properties</b> — take a look at user avatars, which <i>are actually not provided</i> for two of three existing signatures, according to the data we have.
            </p>
            <p class="previous-step-message task-message">
                At this moment, we want to offer you a task. Try to implement a filtering feature, in order to show only cat-pins marked with a certain tag. Computed properties usage is advised.                
            </p>
        </div>
    </div>

    <footer id="footer">
        Vue Examples by <a href="http://github.com/gbezyuk">gbezyuk</a>
    </footer>

    <script src="./js/vue@2.0.5.js"></script>

    <script type="text/x-template" id="root-template">
        <div id="app">

            <h1>{{ title }}</h1>

            <div class="cat-pins">
                <cat-pin v-for="cat_pin in filtered_cat_pins"
                    :image_url="cat_pin.image_url"
                    :author="cat_pin.author"
                    :description="cat_pin.description"
                    :tags="cat_pin.tags"
                ></cat-pin>
                <link rel="stylesheet" href="./css/cats.css" type="text/css">
            </div>
        </div>
    </script>

    <script type="text/x-template" id="author-signature-template">
        <div class="author-signature">
            <div class="avatar"><img :src="avatar"></div>
            <span class="name">{{ name }}</span>
            <span class="status">{{ status }}</span>
        </div>
    </script>

    <script type="text/x-template" id="cat-pin-template">
        <div class="cat-pin">
            <div class="image"><img :src="image_url"></div>
            <ul class="tags">
                <li v-for="tag in tags">{{ tag }}</li>                
            </ul>
            <p class="description">{{ description }}</p>
            <author-signature :avatar_url="author.avatar_url" :name="author.name" :status="author.status" :gender="author.gender">
        </div>
    </script>    

    <script>
        Vue.component('cat-pin', {
            template: '#cat-pin-template',
            props: ['image_url', 'author', 'tags', 'description'],
            components: {
                'author-signature': {
                    template: '#author-signature-template',
                    props: ['name', 'avatar_url', 'status', 'gender'],
                    computed: {
                        avatar: function () {                            
                            return this.avatar_url ||
                                ((this.gender == 'female')
                                    ? '../img/avatars/default-female-avatar.jpg'
                                    : '../img/avatars/default-male-avatar.png')
                        }
                      }

                }
            }
        });        

        var app = new Vue({
          el: '#app',
          template: '#root-template',
          computed: {
              filtered_cat_pins: function () {
                    var term = this.filter_value;
                    if (!term) return this.cat_pins;
                    return this.cat_pins.filter(function (pin) {
                        return pin.tags.indexOf(term) > -1;
                    })
              }
          },
          data: {
            title: 'CatInterest',
            filter_value: '',
            cat_pins: [
                {
                    image_url: './img/cats/munchkin-kitten.jpg',
                    tags: ['munchkin', 'kitten', 'cat'],
                    description: 'A nice munchkin kitten pic',
                    author: {
                        name: 'Told Myself',
                        status: 'Okay, you were right for me',
                        avatar_url: '',
                        gender: 'male'
                    }
                },
                {
                    image_url: './img/cats/siam-kitten.jpg',
                    tags: ['siam', 'kitten', 'cat'],
                    description: 'Awesome siam kitten pic',
                    author: {
                        name: 'But Felt',
                        status: '... felt so lonely in your company =(',
                        avatar_url: '',
                        gender: 'female'
                    }
                },
                {
                    image_url: './img/cats/standing-cat.jpg',
                    tags: ['cat', 'standing', 'cute'],
                    description: 'A well-known standing cat',
                    author: {
                        name: 'But That',
                        status: 'it`s an ache I still remember',
                        avatar_url: '../img/avatars/mr-black-avatar.png',
                        gender: 'male'
                    }
                }
            ]
          }
        })
    </script>
</body>

</html>